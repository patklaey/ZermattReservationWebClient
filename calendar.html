<!DOCTYPE html>
<html lang="en">

	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>

	<body>

		<link rel="stylesheet" href="./bootstrap/dist/css/bootstrap.css"/>
		<link rel="stylesheet" href="./css/calendar.css"/>
		<script src="./js/calendar.js"></script>

		<div class="App" ng-app="App">
            <div class="header" ng-controller="loginController">
                <form action="/" id="login">
                    Username: <input type="text" id="username" ng-model="username">
                    Password: <input type="password" id="password" ng-model="password"><br>
                    <button type="button" class="btn btn-default" ng-click="login()">Login</button>
                </form>
            </div>

	    	<div ng-controller="CalendarCtrl" class="calendar">
			<div class="btn-toolbar">
                		<div class="btn-group">
                		    <button type="button" class="btn btn-default" ng-class="{active:mode==='month'}"
                            		ng-click="changeMode('month')">
                        			Month
 				    </button>
                    		    <button type="button" class="btn btn-default" ng-class="{active:mode==='week'}"
                            		ng-click="changeMode('week')">
                        			Week
                    		    </button>
                    		    <button type="button" class="btn btn-default" ng-class="{active:mode==='day'}"
                            		ng-click="changeMode('day')">
                        			Day
                    		    </button>
                		</div>
                		<div class="btn-group">
                    			<button type="button" class="btn btn-default" ng-disabled="isToday()"
                            			ng-click="today()">
                        			Today
                    			</button>
				</div>
                	</div>
            		<div class="well well-sm" id="calContent">
                		<calendar ng-model="currentDate" calendar-mode="mode" event-source="eventSource"
                          	    range-changed="reloadSource(startTime, endTime)"
                          	    event-selected="onEventSelected(event)"
                          	    time-selected="onTimeSelected(selectedTime)"></calendar>
            		</div>
		</div>

	    	<div class="footer" ng-controller="CalendarCtrl">
			<form action="/" id="addEvent">
				Title: <input type="text" id="title" ng-model="title"><br>
				Start Date: <input type="text" id="startDate" ng-model="startDate"><br>
				End Date: <input type="text" id="endDate" ng-model="endDate"><br>
				<button type="button" class"btn btn-default" ng-click="addEvent()">Submit</button>
			</form>
		</div>
		</div>

		<script>
var myAppModule = angular.module('App', ['ui.rCalendar']);
myAppModule.controller('CalendarCtrl', ['$scope', '$rootScope', function ($scope, $rootScope) {
    'use strict';
    $scope.changeMode = function (mode) {
        $scope.mode = mode;
    };

    $scope.today = function () {
        $scope.currentDate = new Date();
    };

    $scope.initEvent = function () {
        var events = [];
        events.push({ id: 1, title: "My event #1", startTime: new Date("December 12, 2016 12:00:00"), endTime: new Date("December 13, 2016 12:00:00"), allDay: false});
        $rootScope.eventSource = events;
        $rootScope.nextId = 2;
	$scope.loadEvents();
    }

    $scope.loadEvents = function () {
        $scope.eventSource = $rootScope.eventSource;
    };

    $scope.isToday = function () {
        var today = new Date(),
            currentCalendarDate = new Date($scope.currentDate);

        today.setHours(0, 0, 0, 0);
        currentCalendarDate.setHours(0, 0, 0, 0);
        return today.getTime() === currentCalendarDate.getTime();
    };

    $scope.onEventSelected = function (event) {
        $scope.event = event;
    };

    $scope.onTimeSelected = function (selectedTime) {
        console.log('Selected time: ' + selectedTime);
	console.log($scope.eventSource);
    };

    $scope.addEvent = function() {
        console.log($scope.title + " " + $scope.startDate + " " + $scope.endDate);
        var events = $rootScope.eventSource;
	if( events == null || events == undefined ){
		events = [];
	}
	events.push({id: $rootScope.nextId, title: $scope.title, startTime: new Date($scope.startDate), endTime: new Date($scope.endDate), allDay: false});
	$rootScope.nextId = $rootScope.nextId + 1;
	$rootScope.eventSource = events;
	console.log(events);
    };

}]);

myAppModule.controller('loginController', function($scope) {
	$scope.login = function() {
		alert($scope.username + " " + $scope.password);
	};
});
		</script>
	</body>
</html>
